<mujoco model="dobbe">
  <compiler angle="radian" meshdir="" texturedir=""/>

  <asset>
    <mesh name="gripper_body" file="meshes/gripper_body.stl" scale="0.001 0.001 0.001"/>
    <mesh name="finger" file="meshes/finger.stl" scale="0.001 0.001 0.001"/>
    <mesh name="foam_insert" file="meshes/foam_insert.stl" scale="0.0011 0.0011 0.001"/>
    <!-- <mesh name="iphone" file="meshes/iphone.stl" scale="0.001 0.001 0.001"/> -->
    <mesh name="foam_collision" file="meshes/foam_insert.stl" scale="0.0011 0.00125 0.001"/>
    <material name="white" rgba="1 1 1 1"/>
    <material name="gray" rgba="0.15 0.15 0.15 1"/>
    <material name="light_gray" rgba="0.6 0.6 0.6 1"/>
    <material name="light_blue" rgba="0.345 0.65 0.976 1"/>
    <material name="black" rgba="0.05 0.05 0.05 1"/>
  </asset>

  <default>
    <default class="dobbe">
      <joint frictionloss="0.1" armature="1.0"/>
      <position kp="100"/>
    </default>

    <default class="finger_hinge">
      <joint type="hinge" stiffness="0.1" damping="1" armature="1" range="-1.57 0" frictionloss="0.2"/>
      <position kp="100" dampratio="1" ctrlrange="-1.57 0"/>
    </default>

    <default class="finger_actuator">
      <position ctrlrange="-0.8 0" kp="50" dampratio="1"/>
    </default>

    <default class="friction">
      <geom condim="6" friction="0.5 0.5 0.1" priority="1" solref="0.01 1" solimp="0.99 0.99 0.01" conaffinity="1"
        contype="1"/>
    </default>

    <default class="visual">
      <geom type="mesh" contype="0" conaffinity="0" density="0" group="0"/>
    </default>

    <default class="collision">
      <geom type="mesh" group="3" friction="2 0.005 0.0001" density="100"/>
    </default>
  </default>

  <worldbody>

    <body name="target_ee_pose" mocap="true" pos="0 -0.35 0.85" quat="9.91445061e-01 -1.30524675e-01 0 0">
      <geom name="target_ee_pose" type="box" rgba="1 0 0 1.0" size="0.02 0.02 0.02" conaffinity="0" contype="0"
        mass="10.0"/>
      <site name="target_ee_pose" pos="0 0 0" rgba="1 0 0 1.0"/>
    </body>

    <body name="base" pos="0 -0.35 0.85" euler="0.0 0 0" gravcomp="1">

      <joint type="free" name="rum_free_joint"/>

      <geom name="gripper_body_visual" mesh="gripper_body" class="visual" material="white" mass="0.01"/>
      <!-- <geom name="gripper_body_collision" mesh="gripper_body" class="collision"/> -->

      <body name="iphone_body" pos="0 0 0" gravcomp="1">
        <!-- <geom name="iphone_visual" mesh="iphone" class="visual" material="gray"/>
        <geom name="iphone_collision" mesh="iphone" class="collision"/> -->

        <body name="camera_body" pos="0.0 -0.036 0.1" euler="1.309 0 0.0" gravcomp="1">
          <camera name="egocentric" mode="fixed" fovy="53.1"/>
        </body>
      </body>

      <site name="gripper" pos="0 0.12 0" rgba="0 0 0 1"/>
      <!-- <geom name="gripper" type="sphere" pos="0 0.12 0" rgba="0 0 1 1" size="0.01" conaffinity="0" contype="0"/> -->

      <body name="fingers" pos="0 0 0.0" gravcomp="1">
        <body name="left_finger" pos="0 0 -0.0042" gravcomp="1">
          <joint name="finger_left_joint" axis="0 0 1" class="finger_hinge" pos="-0.0242 0.04224 0.0"/>
          <geom name="left_finger_visual" mesh="finger" class="visual" material="light_blue" mass="0.01"/>
          <geom name="left_finger_foam_visual" mesh="foam_insert" class="visual" material="black"
            pos="-0.00468 0.101585 0.00197" euler="0 0 3.75"/>
          <geom name="left_finger_pad" type="box" size="0.005 0.043 0.0131" rgba="1 0 0 0"
            pos="-0.058 0.095
          0.0179" euler="0 0 0.61" contype="1" conaffinity="1" class="friction"/>
        </body>

        <body name="right_finger" pos="0 0 0.0317" euler="0 3.1415 0" gravcomp="1">
          <joint name="finger_right_joint" axis="0 0 1" class="finger_hinge" pos="-0.0242 0.04224 0.0"/>
          <geom name="right_finger_visual" mesh="finger" class="visual" material="light_blue" mass="0.01"/>
          <geom name="right_finger_foam" mesh="foam_insert" class="visual" material="black"
            pos="-0.00468 0.101585 0.00197" euler="0 0 3.75"/>
          <geom name="right_finger_pad" type="box" size="0.005 0.043 0.0131" rgba="1 0 0 0"
            pos="-0.058 0.095
          0.0179" euler="0 0 0.61" contype="1" conaffinity="1" class="friction"/>
        </body>
      </body>
    </body>
  </worldbody>

  <tendon>
    <fixed name="split">
      <joint joint="finger_right_joint" coef="0.5"/>
      <joint joint="finger_left_joint" coef="0.5"/>
    </fixed>
  </tendon>

  <actuator>
    <position name="fingers_actuator" tendon="split" class="finger_actuator"/>
  </actuator>
  <equality>
    <weld site1="target_ee_pose" site2="gripper" solref="0.05 1" solimp="0.8 0.95 0.01"/>
  </equality>
</mujoco>